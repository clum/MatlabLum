classdef test_tableManipulator_MovingAverage < matlab.unittest.TestCase
    %Test the tableManipulator.MovingAverage function
    %
    %Christopher Lum
    %lum@uw.edu
    
    %Version History
    %01/06/25: Created
    
    methods(Test)
        function example01(tc)
            debug = false;
            
            T = tableConstants.SetupTable(tableID.Spending01);
            
            tableManip = tableManipulator(T);
            T2 = tableManip.MovingAverage('WindowSize',5);
            
            expectedValues = [40.7361843196589,27.1881070741470,309.336451261344;46.2895968537810,29.2039201589536,338.100123609423;10.3493408146753,12.5044694077852,326.248384689764;54.6687928069510,13.7599072623351,313.293058483845;39.9323754212673,22.9181931965013,312.032616344269;37.7605426073296,28.1585234498006,305.336255034882;38.4876054252439,28.6408252313389,296.575024342643;51.6865524543587,35.0220733576201,295.556176553946;63.1278622473115,38.8605874210822,296.736963927932;79.4531551370502,43.8838114796703,299.675590371971;95.0538819038316,41.2466207352158,296.614396576054;118.974827532767,45.5711913352078,290.635685476113;142.077681823147,49.4816631086231,276.899686932671;158.356369956032,57.8183936129804,272.736191947813;179.710289292928,62.4825885401787,275.934251514110;204.553021862424,67.8195518562150,284.703051707849;226.064706871081,67.8808909855233,280.964602050672;254.650392640542,66.4826292487423,277.157456112235;288.718709448909,64.4154692614458,262.815545166791;323.310829023950,66.4668759076715,257.312498164170;363.449372629244,67.1234090997333,249.939439672636;396.588876588723,75.5286921656544,257.867203019592;434.922814395520,79.2825398709819,262.830229820395;477.340673577500,87.6565828234898,263.831082487072;517.533100862149,86.7307149034990,249.233575644989;563.553095176366,89.2692194751764,242.332684189826;617.627303071874,87.7636117304341,235.797860690322;662.058280208527,93.7437693898073,238.485815673917;710.273126632727,93.0959711955313,239.564887561415;758.197641962265,96.1093771241568,242.973824921689;812.680701536678,104.183244143877,233.532131952942;862.567705319203,109.856686009291,223.556150460154;920.414664973470,112.326117466447,214.199277978140;975.321599978006,118.877355985864,213.801242796407;1037.58105091225,121.350792079923,217.709409897668;1103.75516831533,123.761764889638,220.455648979625;1177.38512608131,128.109484914644,215.645545442791;1246.78689103231,129.755262824118,205.472251462232;1326.82739761438,129.960286639281,202.552767127925;1399.20054060705,131.280408805223,200.677620871979;1470.35340592034,128.654407921670,203.344882612992;1544.22070426152,129.870955591514,205.124155749007;1627.70487734240,136.060726656527,202.027374674824;1707.15465586538,141.990239004559,187.596128190610;1791.67892110590,145.422654355844,176.626733555950;1877.18912146722,152.541642693489,172.895675063936;1964.82939890340,155.050387397883,174.282090653149;2052.63736112302,151.912266113076,176.551525628592;2142.77901042023,150.137161794434,175.980448380782;2241.45715119451,153.395370592190,166.010150574226;2334.31975800661,158.199057630684,161.006863355278];
            
            tol = 1e-8;
            tc.verifyTrue(AreMatricesSame(T2{:,:},expectedValues,tol));
            
            if(debug)
                figure
                
                subplot(3,1,1)
                hold on
                plot(T{:,1})
                plot(T2{:,1})
                grid on
                
                subplot(3,1,2)
                hold on
                plot(T{:,2})
                plot(T2{:,2})
                grid on
                
                subplot(3,1,3)
                hold on
                plot(T{:,3})
                plot(T2{:,3})
                grid on
            end
            
            %Clean up
            close all
        end
    end
end